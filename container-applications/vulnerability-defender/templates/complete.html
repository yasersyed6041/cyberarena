{% extends "base.html" %}
{% block title %}Vulnerability Defender Results{% endblock %}
{% block content %}
    <div class="container">
    <div class='search_form container'>
        <form class="border border-light p-5">
            {% if data['complete'] %}
                <h3 class="h3 mb-4 text-center">CONGRATULATIONS! You have successfully completed this workout!</h3>
                <img class="displayed" src="/static/imgs/trojan-4.png">
            {% endif %}
            <p class="h4 mb-4 text-center">Your Score: {{ data['points'] }}</p>
            <p class="h4 mb-4 text-center">Company: {{ data['company'] }}</p>
            <p class="h4 mb-4 text-center">Mission: {{ data['mission'] }}</p>
            <label for="system">System affected:</label>
            <input type="text" id="system" name="system" value="{{ data['system'] }}" readonly>
            <table>
              <tr>
                  <th>Mission Confidentiality Impact</th>
                  <th>Mission Integrity Impact</th>
                  <th>Mission Availability Impact</th>
              </tr>
              <tr>
                  <td>{{ data['confidentiality_impact'] }}</td>
                  <td>{{ data['integrity_impact'] }}</td>
                  <td>{{ data['availability_impact'] }}</td>
              </tr>
              <tr>
                  <td>{{ data['confidentiality_scenario'] }}</td>
                  <td>{{ data['integrity_scenario'] }}</td>
                  <td>{{ data['availability_scenario'] }}</td>
              </tr>
            </table>
            {% for cve, vuln in data['vulnerabilities'].items() %}
                <table {% if vuln['correct'] %} bgcolor="#8fbc8f" {% else %} bgcolor="#f08080" {% endif %}>
                  <tr>
                      <td class="text-dark">Affected Asset:</td>
                      <td class="text-dark">{{ vuln['asset'] }}</td>
                      <td class="text-dark">Vulnerability:</td>
                      <td class="text-dark"><a href="https://nvd.nist.gov/vuln/detail/{{ cve }}" target="_blank">{{ cve }}</a></td>
                  </tr>
                  <tr>
                      <td class="text-dark">Description:</td>
                      <td class="text-dark" colspan="3">{{ vuln['description'] }}</td>
                  </tr>
                    <tr>
                        <td class="text-dark">Exploitable from:</td>
                        <td class="text-dark">{{ vuln['attack_vector'] }}</td>
                        <td class="text-dark">Complexity of attack:</td>
                        <td class="text-dark">{{ vuln['complexity'] }}</td>
                    </tr>
                    <tr>
                        <td class="text-dark">Given Answer:</td>
                        <td class="text-dark">{{ vuln['response'] }}</td>
                        <td class="text-dark">Correct Answer:</td>
                        <td class="text-dark">{{ vuln['correct_answer'] }}</td>
                  </tr>
                  <tr>
                      <td class="text-dark" colspan="4">Given Rationale: {{ vuln['rationale'] }} </td>
                  </tr>
                </table>

                {% if data.level == "1" %}
                    <table>
                      <tr>
                          <th>Vulnerability Confidentiality Impact</th>
                          <th>Vulnerability Integrity Impact</th>
                          <th>Vulnerability Availability Impact</th>
                      </tr>
                      <tr>
                          <td>{{ vuln['v_confidentiality'] }}</td>
                          <td>{{ vuln['v_integrity'] }}</td>
                          <td>{{ vuln['v_availability'] }}</td>
                      </tr>
                    </table>
                    <p></p>
                {% endif %}
            {% endfor %}
            <table>
            <button class="btn btn-info btn-block my-4" type="submit" name="action" value="startover"
                                formmethod="post" onclick="conf_startover()" formnovalidate>Start Over</button>
        </form>
    </div>
    </div>
{% endblock %}
{% block js_block %}
    {# JS for Query Reference Page Modal #}
     <script>
         function conf_startover()
         {
             var con=confirm("Are you sure want to start over?");
         }
     </script>
{% endblock js_block %}