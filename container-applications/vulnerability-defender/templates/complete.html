{% extends "base_template.html" %}
{% block title %}Vulnerability Defender Results{% endblock %}

{% block content %}
    <div class="container">
    <div class='search_form container'>
        <form class="border border-light p-5">
            <p class="h4 mb-4 text-center">Your Score: {{ data['points'] }}</p>
            <p class="h4 mb-4 text-center">Company: {{ data['company'] }}</p>
            <p class="h4 mb-4 text-center">Mission: {{ data['mission'] }}</p>
            <label for="system">System affected:</label>
            <input type="text" id="system" name="system" value="{{ data['system'] }}" readonly>
            <table>
              <tr>
                  <th>Mission Confidentiality Impact</th>
                  <th>Mission Integrity Impact</th>
                  <th>Mission Availability Impact</th>
              </tr>
              <tr>
                  <td><input type="text" value="{{ data['confidentiality_impact'] }}" readonly></td>
                  <td><input type="text" value="{{ data['integrity_impact'] }}" readonly></td>
                  <td><input type="text" value="{{ data['availability_impact'] }}" readonly></td>
              </tr>
              <tr>
                  <td>{{ data['confidentiality_scenario'] }}</td>
                  <td>{{ data['integrity_scenario'] }}</td>
                  <td>{{ data['availability_scenario'] }}</td>
              </tr>
            </table>
            {% for cve, vuln in data['vulnerabilities'].items() %}
                <table {% if vuln['correct'] %} bgcolor="#8fbc8f" {% else %} bgcolor="#f08080" {% endif %}>
                  <tr>
                      <td><th>Affected Asset:</th></td>
                      <td>{{ vuln['asset'] }}</td>
                      <td><th>Vulnerability:</th></td>
                      <td><a href="https://nvd.nist.gov/vuln/detail/{{ cve }}" target="_blank">{{ cve }}</a></td>
                  </tr>
                  <tr>
                      <td><th>Description:</th></td>
                      <td colspan="3">{{ vuln['description'] }}</td>
                  </tr>
                    <tr>
                        <td><th>Exploitable from:</th></td>
                        <td>{{ vuln['attack_vector'] }}</td>
                        <td><th>Complexity of attack:</th></td>
                        <td>{{ vuln['complexity'] }}</td>
                    </tr>
                    <tr>
                        <td><th>Given Answer:</th></td>
                        <td>{{ vuln['response'] }}</td>
                        <td><th>Correct Answer:</th></td>
                        <td>{{ vuln['correct_answer'] }}</td>
                  </tr>
                  <tr>
                      <td colspan="4">Given Rationale: {{ vuln['rationale'] }} </td>
                  </tr>
                </table>

                {% if data.level == "1" %}
                    <table>
                      <tr>
                          <th>Vulnerability Confidentiality Impact</th>
                          <th>Vulnerability Integrity Impact</th>
                          <th>Vulnerability Availability Impact</th>
                      </tr>
                      <tr>
                          <td><input type="text" value="{{ vuln['v_confidentiality'] }}" readonly></td>
                          <td><input type="text" value="{{ vuln['v_integrity'] }}" readonly></td>
                          <td><input type="text" value="{{ vuln['v_availability'] }}" readonly></td>
                      </tr>
                    </table>
                    <p></p>
                {% endif %}
            {% endfor %}
            <table>
            <button class="btn btn-info btn-block my-4" type="submit" name="action" value="startover"
                                formmethod="post" onclick="conf_startover()" formnovalidate>Start Over</button>
        </form>
    </div>
    </div>
{% endblock %}
{% block js_block %}
    {# JS for Query Reference Page Modal #}
     <script>
         function conf_startover()
         {
             var con=confirm("Are you sure want to start over?");
         }
     </script>
{% endblock js_block %}