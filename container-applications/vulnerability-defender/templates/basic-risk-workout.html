{% extends "base.html" %}
{% block title %}Vulnerability Defender{% endblock %}

{% block content %}
    <div class="container">

    <div class='workout_info'>
        <h3 class="h3 mb-4 text-center">Vulnerability Defender Workout - Basic Level</h3>
    </div>

    <div class='search_form container'>
        <form class="border border-light p-5">
            <p class="h4 mb-4 text-center">Company and Asset Risk Profile</p>

            <label for="textInput">Company Name:</label>
            <input type="text" name="company" id="company" class="form-control mb-4" placeholder="Company Name" required>

            <label for="textarea">Company Mission:</label>
            <textarea name="mission" id="mission" class="form-control mb-4" placeholder="Our company exists to..." required></textarea>

            <label for="select">Select a sample system</label>
            <select class="browser-default custom-select mb-4" name="system" id="system" onchange="changeSelect()">
                <option value="Choose a System" disabled="" selected="">Choose a system</option>
                {% for system_key in sample_systems %}
                    <option value={{ system_key }}>{{ sample_systems[system_key]["name"] }}</option>
                {% endfor %}
            </select>
            <div id="description"></div>

            <label for="select">What is the overall impact of this service to the organizational mission?</label>
            <select class="browser-default custom-select mb-4" name="service-impact" id="service-impact" required>
                <option value="" disabled="" selected="">Choose an impact level</option>
                <option value="HIGH">High</option>
                <option value="LOW">Low</option>
                <option value="NONE">No Impact</option>
            </select>

            <div id="confidentiality_scenario"></div>
            <label for="select">What is the impact to the mission for loss of <b>CONFIDENTIALITY</b>?</label>
            <select class="browser-default custom-select mb-4" name="confidentiality-impact" id="confidentiality-impact" required>
                <option value="" disabled="" selected="">Choose an impact level</option>
                <option value="HIGH">High</option>
                <option value="LOW">Low</option>
                <option value="NONE">No Impact</option>
            </select>

            <div id="integrity_scenario"></div>
            <label for="select">What is the impact to the mission for loss of <b>INTEGRITY</b>?</label>
            <select class="browser-default custom-select mb-4" name="integrity-impact" id="integrity-impact" required>
                <option value="" disabled="" selected="">Choose an impact level</option>
                <option value="HIGH">High</option>
                <option value="LOW">Low</option>
                <option value="NONE">No Impact</option>
            </select>

            <div id="availability_scenario"></div>
            <label for="select">What is the impact to the mission for loss of <b>AVAILABILITY</b>?</label>
            <select class="browser-default custom-select mb-4" name="availability-impact" id="availability-impact" required>
                <option value="" disabled="" selected="">Choose an impact level</option>
                <option value="HIGH">High</option>
                <option value="LOW">Low</option>
                <option value="NONE">No Impact</option>
            </select>

            <button class="btn btn-info btn-block my-4" type="submit" formmethod="post">Get Vulnerabilities</button>
        </form>
    </div>
    </div>
{% endblock %}
{% block js_block %}
    {# JS for Query Reference Page Modal #}
     <script>
        var sample_systems = JSON.parse('{{sample_systems | tojson}}');
        // Modifies the form description based on the selected system
        function changeSelect() {
            var system_key = document.getElementById("system").value;
            document.getElementById("description").innerHTML = "<label for=\"textarea\"><b>System Description: </b>"
                + sample_systems[system_key]["description"] + "</label>";

            document.getElementById("confidentiality_scenario").innerHTML = "<label for=\"textarea\">" +
                "<b>Scenario involving loss of confidentiality: </b>"
                + sample_systems[system_key]["confidentiality_scenario"] + "</label>";
            document.getElementById("confidentiality-impact").value  = sample_systems[system_key]["confidentiality_base"]

            document.getElementById("integrity_scenario").innerHTML = "<label for=\"textarea\">" +
                "<b>Scenario involving loss of integrity: </b>"
                + sample_systems[system_key]["integrity_scenario"] + "</label>";
            document.getElementById("integrity-impact").value  = sample_systems[system_key]["integrity_base"]

            document.getElementById("availability_scenario").innerHTML = "<label for=\"textarea\">" +
                "<b>Scenario involving loss of availability: </b>"
                + sample_systems[system_key]["availability_scenario"] + "</label>";
            document.getElementById("availability-impact").value  = sample_systems[system_key]["availability_base"]
        }
     </script>
{% endblock js_block %}
