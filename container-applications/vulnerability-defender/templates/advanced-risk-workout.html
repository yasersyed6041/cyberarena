{% extends "base.html" %}
{% block title %}Vulnerability Defender{% endblock %}

{% block content %}
    <div class="container">

    <div class='workout_info'>
        <h3 class="h3 mb-4 text-center">Vulnerability Defender Lab</h3>
    </div>

    <div class='search_form container'>
        <form class="border border-light p-5">
            <p class="h4 mb-4 text-center">Company and Asset Risk Profile</p>

            <label for="textInput">Company Name:</label>
            <input type="text" name="company" id="company" class="form-control mb-4" placeholder="Company Name" required>

            <label for="textarea">Company Mission:</label>
            <textarea name="mission" id="mission" class="form-control mb-4" placeholder="Our company exists to..." required></textarea>

            <label for="textarea">What is a sample service that you wish to assess?:</label>
            <textarea name="service" id="service" class="form-control mb-4" placeholder="Manufacturing product x..." required></textarea>

            <label for="select">What is the overall impact of this service to the organizational mission?</label>
            <select class="browser-default custom-select mb-4" name="service-impact" id="service-impact" required>
                <option value="Choose an impact level" disabled="" selected="">Choose an impact level</option>
                <option value="HIGH">High</option>
                <option value="LOW">Low</option>
                <option value="NONE">No Impact</option>
            </select>

            <label for="select">Select a sample system associated with the service</label>
            <select class="browser-default custom-select mb-4" name="system" id="system">
                {% for system_key in sample_systems %}
                    <option value={{ system_key }}>{{ sample_systems[system_key]["name"] }}</option>
                {% endfor %}
            </select>

            <label for="textarea">Come up with a scenario in which <b>Confidentiality</b> of data is lost on the sample system</label>
            <textarea name="confidentiality-scenario" id="confidentiality-scenario" class="form-control mb-4" placeholder="Loss of confidentiality scenario" required></textarea>

            <label for="select">Impact to Mission for Loss of <b>Confidentiality</b></label>
            <select class="browser-default custom-select mb-4" name="confidentiality-impact" id="confidentiality-impact" required>
                <option value="Choose an impact level" disabled="" selected="">Choose an impact level</option>
                <option value="HIGH">High</option>
                <option value="LOW">Low</option>
                <option value="NONE">No Impact</option>
            </select>

            <label for="textarea">Come up with a scenario in which <b>Integrity</b> is lost on the sample system</label>
            <textarea name="integrity-scenario" id="integrity-scenario" class="form-control mb-4" placeholder="Loss of integrity scenario" required></textarea>

            <label for="select">Impact to Mission for Loss of <b>Integrity</b></label>
            <select class="browser-default custom-select mb-4" name="integrity-impact" id="integrity-impact" required>
                <option value="Choose an impact level" disabled="" selected="">Choose an impact level</option>
                <option value="HIGH">High</option>
                <option value="LOW">Low</option>
                <option value="NONE">No Impact</option>
            </select>

            <label for="textarea">Come up with a scenario in which <b>Availability</b> is lost on the sample system</label>
            <textarea name="availability-scenario" id="availability-scenario" class="form-control mb-4" placeholder="Loss of availability scenario" required></textarea>

            <label for="select">Impact to Mission for Loss of <b>Availability</b> </label>
            <select class="browser-default custom-select mb-4" name="availability-impact" id="availability-impact" required>
                <option value="Choose an impact level" disabled="" selected="">Choose an impact level</option>
                <option value="HIGH">High</option>
                <option value="LOW">Low</option>
                <option value="NONE">No Impact</option>
            </select>

            <button class="btn btn-info btn-block my-4" type="submit" formmethod="post">Get Vulnerabilities</button>
        </form>
    </div>

    <div class='shodan_result_list container'>
    {% if resultCount %}

    {% endif %}
    </div>
    </div>
{% endblock %}
{% block js_block %}
    {# JS for Query Reference Page Modal #}
     <script>
            // Allow the user to select their own system
            function CheckSystem(val){
             var element=document.getElementById('system');
             if(val=='Choose a System'||val=='Other')
               element.style.display='block';
             else
               element.style.display='none';
            }

     </script>
{% endblock js_block %}
