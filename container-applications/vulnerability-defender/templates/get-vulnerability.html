{% extends "base_template.html" %}
{% block content %}
    <div class="container">

    <div class='workout_info'>
        <br>
        <h3 class="h3 mb-4 text-center">Vulnerability Defender Workout Level {{ data['level'] }}</h3>
        <br>
        <p><br></p>
    </div>

    <div class='search_form container'>
        <form class="border border-light p-5">
            <p class="h4 mb-4 text-center">Analyze the Risk to the {{ data['company'] }}'s Mission for the following vulnerability</p>
            <p class="h4 mb-4 text-center">Your Score: {{ data['score'] }}</p>
            <label for="system">System affected:</label>
            <input type="text" id="system" name="system" value="{{ data.system }}" readonly>
            <table bgcolor="#f5f5dc">
              <tr>
                  <th>Mission Confidentiality Impact</th>
                  <th>Mission Integrity Impact</th>
                  <th>Mission Availability Impact</th>
              </tr>
              <tr>
                  <td><input type="text" value="{{ data.mission_confidentiality }}" readonly></td>
                  <td><input type="text" value="{{ data.mission_integrity }}" readonly></td>
                  <td><input type="text" value="{{ data.mission_availability }}" readonly></td>
              </tr>
            </table>

            <table>
              <tr>
                  <td><th>Affected Asset:</th></td>
                  <td>{{ data.asset }}</td>
                  <td><th>Vulnerability:</th> </td>
                  <td><a href="https://nvd.nist.gov/vuln/detail/{{ data.cve_id }}" target="_blank">{{ data.cve_id }}</a></td>
              </tr>
              <tr>
                  <td><th>Vulnerability Description:</th></td>
                  <td colspan="3">{{ data.description }}</td>
              </tr>
                <tr>
                    <td><th>Exploitable from:</th></td>
                    <td>{{ data.attack_vector }}</td>
                    <td><th>Complexity of attack:</th></td>
                    <td>{{ data.complexity }}</td>
                </tr>
            </table>

            {# Display the vulnerability impacts only on level 1 #}
            {% if data.level == "1" %}
                <table bgcolor="#f08080">
                  <tr>
                      <th>Vulnerability Confidentiality Impact</th>
                      <th>Vulnerability Integrity Impact</th>
                      <th>Vulnerability Availability Impact</th>
                  </tr>
                  <tr>
                      <td><input type="text" value="{{ data.v_confidentiality }}" readonly></td>
                      <td><input type="text" value="{{ data.v_integrity }}" readonly></td>
                      <td><input type="text" value="{{ data.v_availability }}" readonly></td>
                  </tr>
                </table>
            {% endif %}

            <label for="select">What is the potential impact of this vulnerability to the organization's mission?</label>
            <select class="browser-default custom-select mb-4" name="vulnerability-impact" id="vulnerability-impact" required>
                <option value="Choose an impact level" disabled="" selected="">Choose an impact level</option>
                <option value="HIGH">High</option>
                <option value="LOW">Low</option>
                <option value="NONE">No Impact</option>
            </select>
            <label for="textarea">How could an adversary use this to impact the mission of {{ data.company }}</label>
            <textarea name="impact-rationale" id="impact-rationale" class="form-control mb-4" required></textarea>

             <input type="hidden" id="cve_id" name="cve_id" value={{ data.cve_id }}>

            <table>
                <tr>
                    <td>
                        <button class="btn btn-info btn-block my-4" type="submit" name="action" value="next" formmethod="post">Next</button>
                    </td>
                    <td>
                        <button class="btn btn-info btn-block my-4" type="submit" name="action" value="complete"
                                formmethod="post" onclick="return conf_complete();" formnovalidate>Complete</button>
                    </td>
                    <td>
                        <button class="btn btn-info btn-block my-4" type="submit" name="action" value="startover"
                                formmethod="post" onclick="return conf_startover();" formnovalidate>Start Over</button>
                    </td>
                </tr>
            </table>
        </form>
    </div>

    <div class='shodan_result_list container'>
    {% if resultCount %}

    {% endif %}
    </div> {# shodan_result_list #}
{% endblock %}
{% block js_block %}
    {# JS for Query Reference Page Modal #}
     <script>
         function conf_startover()
         {
             var con=confirm("Are you sure want to start over?");
             return con;
         }
         function conf_complete()
         {
             var con=confirm("Are you sure want to finish this workout?");
             return con;
         }
     </script>
{% endblock js_block %}
