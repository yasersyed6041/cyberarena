{% extends "base.html" %}
{% block content %}
    <div class="container">

    <div class='workout_info'>
        <br>
        <h3 class="h3 mb-4 text-center">Vulnerability Defender Workout Level {{ data['level'] }}</h3>
        <br>
        <p><br></p>
    </div>

    <div class='search_form container'>
        <form class="border border-light p-5">
            <p class="h4 mb-4 text-center">Analyze the Risk to the {{ data['company'] }}'s Mission for the following vulnerability</p>
            <img class="displayed" src={{ data.score_img }}>
            <p class="h4 mb-4 text-center">Your Score: {{ data['score'] }}</p>
            <p class="h5 mb-4 text-left">System Affected: {{ data.system }}</p>
            <p class="h5 mb-4 text-left">Overall Mission Impact: <b>{{ data.service_impact }}</b></p>
            <table bgcolor="teal">
              <tr>
                  <th class="text-white">Mission Confidentiality Impact</th>
                  <th class="text-white">Mission Integrity Impact</th>
                  <th class="text-white">Mission Availability Impact</th>
              </tr>
              <tr>
                  <td><label for="textarea" class="h5 mb-4 text-left text-white">{{ data.mission_confidentiality }}</label></td>
                  <td><label for="textarea" class="h5 mb-4 text-left text-white">{{ data.mission_integrity }}</label></td>
                  <td><label for="textarea" class="h5 mb-4 text-left text-white">{{ data.mission_availability }}</label></td>
              </tr>
            </table>
            <br>
            <table bgcolor="#afeeee">
              <tr>
                  <td class="text-dark">Affected Asset:</td>
                  <td class="text-dark text-left">{{ data.asset }}</td>
                  <td class="text-dark">Vulnerability: </td>
                  <td class="text-left"><a href="https://nvd.nist.gov/vuln/detail/{{ data.cve_id }}" target="_blank">{{ data.cve_id }}</a></td>
              </tr>
              <tr>
                  <td class="text-dark">Vulnerability Description:</td>
                  <td class="text-dark text-left" colspan="3">{{ data.description }}</td>
              </tr>
                {% if workout_level == "advanced" %}
                <tr>
                    <td class="text-dark">Exploitable from:</td>
                    <td class="text-dark">{{ data.attack_vector }}</td>
                    <td class="text-dark">Complexity of attack:</td>
                    <td class="text-dark">{{ data.complexity }}</td>
                </tr>
                {% endif %}
            </table>
            <br>
            {# Display the vulnerability impacts only on level 1 #}
            {% if data.level == "1" %}
                <table bgcolor="#ffd700">
                  <tr>
                      <td class="text-dark"><b>Vulnerability Confidentiality Impact</b></td>
                      <td class="text-dark"><b>Vulnerability Integrity Impact</b></td>
                      <td class="text-dark"><b>Vulnerability Availability Impact</b></td>
                  </tr>
                  <tr>
                      <td><label for="textarea" class="h5 mb-4 text-left text-dark">{{ data.v_confidentiality }}</label></td>
                      <td><label for="textarea" class="h5 mb-4 text-left text-dark">{{ data.v_integrity }}</label></td>
                      <td><label for="textarea" class="h5 mb-4 text-left text-dark">{{ data.v_availability }}</label></td>
                  </tr>
                </table>
            {% endif %}
            <br>
            <table>
                <tr>
                    <td class="h5 mb-5 text-left">
                        What is the potential impact of this vulnerability to the organization's mission?
                    </td>
                </tr>
                <tr>
                    <td>
                        <select class="browser-default custom-select mb-4" name="vulnerability-impact" id="vulnerability-impact" required>
                            <option value="" disabled="" selected="">Choose an impact level</option>
                            <option value="HIGH">High</option>
                            <option value="LOW">Low</option>
                            <option value="NONE">No Impact</option>
                        </select>
                    </td>
                </tr>
                {% if workout_level == "advanced" %}
                <tr>
                    <td class="h5 mb-5">>
                        How could an adversary use this to impact the mission of {{ data.company }}
                    </td>
                </tr>
                <tr>
                    <td>
                        <textarea name="impact-rationale" id="impact-rationale" class="form-control mb-4" required></textarea>
                    </td>
                </tr>
                {% endif %}
            </table>

             <input type="hidden" id="cve_id" name="cve_id" value={{ data.cve_id }}>

            <table>
                <tr>
                    <td style="border: none">
                        <button class="btn btn-info btn-block my-4" type="submit" name="action" value="next"
                                formmethod="post">Next</button>
                    </td>
                    <td style="border: none">
                        <button class="btn btn-info btn-block my-4" type="submit" name="action" value="complete"
                                formmethod="post" onclick="return conf_complete();" formnovalidate>Complete</button>
                    </td>
                    <td style="border: none">
                        <button class="btn btn-info btn-block my-4" type="submit" name="action" value="startover"
                                formmethod="post" onclick="return conf_startover();" formnovalidate>Start Over</button>
                    </td>
                </tr>
            </table>
        </form>
    </div>
{% endblock %}
{% block js_block %}
    {# JS for Query Reference Page Modal #}
     <script>
         function conf_startover()
         {
             var con=confirm("Are you sure want to start over?");
             return con;
         }
         function conf_complete()
         {
             var con=confirm("Are you sure want to finish this workout?");
             return con;
         }
     </script>
{% endblock js_block %}
