{% extends 'base.html' %}
{% block title %}Vulnerability Defender{% endblock %}
{% block styles %}
    <link type="text/css" rel="stylesheet" href="{{ url_for('vulnerability_defender.static', filename='css/vulnerability-defender.css')}}">
{% endblock %}
{% block nav_title %}Vulnerability Defender Workout Level {{ data['level'] }}{% endblock %}
{% block navbar %}
    <div class="navbar-nav mr-auto">
        <ul class="nav nav-pills top-navbar-pill">
            <li class="nav-item pr-1"></li>
        </ul>
    </div>
{% endblock %}
{% block content %}
    <script type="text/javascript" src='{{ url_for("vulnerability_defender.static", filename="js/main.js") }}'></script>
    <script>
        function submit(action){
            let form, data, url;
            form = document.getElementById()
        }
         function conf_startover()
         {
             var con = confirm("Are you sure want to start over?");
             return con;
         }
         function conf_complete()
         {
             var con = confirm("Are you sure want to finish this workout?");
             return con;
         }
     </script>
    <main class="col main pt-3 mt-3 h-100">
        <div class="overflow-auto">
            <div class="tab-content">
                <div class="tab-content fade active show" id="home-tab" role="tabpanel" aria-labelledby="home-tab-btn">
                    <div class="search-form-container">
                        <form >
                            <p class="h4 mb-4 text-center">Analyze the Risk to the {{ data['company'] }}'s Mission for the following vulnerability</p>
                            <div class="risk-score">
                                <img class="risk-score-img flex-item" src={{ url_for('vulnerability_defender.static', filename=data.score_img) }}>
                                <p class="h4 mb-4 text-center">Your Score: {{ data['score'] }}</p>
                            </div>
                            <div style="max-width: 90%; margin: auto;">
                                <p class="h5 mb-4 text-left">System Affected: {{ data.system }}</p>
                                <p class="h5 mb-4 text-left">Overall Mission Impact: <b>{{ data.service_impact }}</b></p>
                            </div>
                            <table class="table vulnerability-table" style="background-color: var(--teal);">
                              <tr>
                                  <th class="text-white">Mission Confidentiality Impact</th>
                                  <th class="text-white">Mission Integrity Impact</th>
                                  <th class="text-white">Mission Availability Impact</th>
                              </tr>
                              <tr>
                                  <td><label for="textarea" class="h5 mb-4 text-left text-white">{{ data.mission_confidentiality }}</label></td>
                                  <td><label for="textarea" class="h5 mb-4 text-left text-white">{{ data.mission_integrity }}</label></td>
                                  <td><label for="textarea" class="h5 mb-4 text-left text-white">{{ data.mission_availability }}</label></td>
                              </tr>
                            </table> <!-- End confidentiality table -->
                            <hr style="width: 90%;">
                            <table class="table vulnerability-table" style="background-color: #afeeee; padding-top: 20px;">
                              <tr>
                                  <td class="text-dark">Affected Asset:</td>
                                  <td class="text-dark text-left">{{ data.asse  t }}</td>
                                  <td class="text-dark">Vulnerability: </td>
                                  <td class="text-left"><a href="https://nvd.nist.gov/vuln/detail/{{ data.cve_id }}" target="_blank">{{ data.cve_id }}</a></td>
                              </tr>
                              <tr>
                                  <td class="text-dark">Vulnerability Description:</td>
                                  <td class="text-dark text-left" colspan="3">{{ data.description }}</td>
                              </tr>
                                {% if workout_level == "advanced" %}
                                <tr>
                                    <td class="text-dark">Exploitable from:</td>
                                    <td class="text-dark">{{ data.attack_vector }}</td>
                                    <td class="text-dark">Complexity of attack:</td>
                                    <td class="text-dark">{{ data.complexity }}</td>
                                </tr>
                                {% endif %}
                            </table><!-- End affected-asset table -->
                            <hr style="width: 90%;">
                            {# Display the vulnerability impacts only on level 1 #}
                            {% if data.level == "1" %}
                                <table class="table vulnerability-table" bgcolor="#ffd700">
                                  <tr>
                                      <td class="text-dark"><b>Vulnerability Confidentiality Impact</b></td>
                                      <td class="text-dark"><b>Vulnerability Integrity Impact</b></td>
                                      <td class="text-dark"><b>Vulnerability Availability Impact</b></td>
                                  </tr>
                                  <tr>
                                      <td><label for="textarea" class="h5 mb-4 text-left text-dark">{{ data.v_confidentiality }}</label></td>
                                      <td><label for="textarea" class="h5 mb-4 text-left text-dark">{{ data.v_integrity }}</label></td>
                                      <td><label for="textarea" class="h5 mb-4 text-left text-dark">{{ data.v_availability }}</label></td>
                                  </tr>
                                </table><!-- End vuln impacts level 1 -->
                                <hr style="width: 90%;">
                            {% endif %}{# End display vuln impacts level 1 #}
                            <table class="table vulnerability-table">
                                <tr>
                                    <td class="h5 mb-5 text-left">
                                        What is the potential impact of this vulnerability to the organization's mission?
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <select class="browser-default custom-select mb-4" name="vulnerability-impact" id="vulnerability-impact" required>
                                            <option value="" disabled="" selected="">Choose an impact level</option>
                                            <option value="HIGH">High</option>
                                            <option value="LOW">Low</option>
                                            <option value="NONE">No Impact</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="h5 mb-5 text-left">
                                        How could an adversary use this to impact the mission of {{ data.company }}
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <textarea name="impact-rationale" id="impact-rationale" class="form-control mb-4" required></textarea>
                                    </td>
                                </tr>
                            </table><!-- End potential impact table -->
                            <hr style="width: 90%;">
                            <input type="hidden" id="cve_id" name="cve_id" value={{ data.cve_id }}>
                            <table class="table vulnerability-table">
                                <tr>
                                    <td style="border: none">
                                        <button class="btn btn-info btn-block my-4" type="submit" name="action" value="next"
                                                formmethod="post">Next</button>
                                    </td>
                                    <td style="border: none">
                                        <button class="btn btn-info btn-block my-4" type="submit" name="action" value="complete"
                                                formmethod="post" onclick="return conf_complete();" formnovalidate>Complete</button>
                                    </td>
                                    <td style="border: none">
                                        <button class="btn btn-info btn-block my-4" type="submit" name="action" value="startover"
                                                formmethod="post" onclick="return conf_startover();" formnovalidate>Start Over</button>
                                    </td>
                                </tr>
                            </table><!-- End final table -->
                        </form>
                    </div>
                </div><!-- End home-tab -->
            </div><!-- End tab-content -->
        </div>
    </main>
{% endblock %}