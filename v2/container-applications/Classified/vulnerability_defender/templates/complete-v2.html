{% extends 'base.html' %}
{% block title %}Vulnerability Defender{% endblock %}
{% block styles %}
    <link type="text/css" rel="stylesheet" href="{{ url_for('vulnerability_defender.static', filename='css/vulnerability-defender.css')}}">
{% endblock %}
{% block nav_title %}Vulnerability Defender Results{% endblock %}
{% block navbar %}
    <div class="navbar-nav mr-auto">
        <ul class="nav nav-pills top-navbar-pill">
            <li class="nav-item pr-1"></li>
        </ul>
    </div>
{% endblock %}
{% block content %}
    <script type="text/javascript" src='{{ url_for("vulnerability_defender.static", filename="js/main.js") }}'></script>
    <script>
         function conf_startover()
         {
             var con=confirm("Are you sure want to start over?");
         }
     </script>
    <main class="col main pt-3 mt-3 h-100">
        <div class="overflow-auto">
            <div class="tab-content">
                <div class="tab-content fade active show" id="home-tab" role="tabpanel" aria-labelledby="home-tab-btn">
                    <div class="container">
                        <div class="summary-container" style="border: none; box-shadow: none; color: white;">
                            {% if workout['complete'] %}
                                <h3 class="h3 mb-4 text-center">CONGRATULATIONS! You have successfully completed this workout!</h3>
                            {% endif %}
                        </div>
                        <div class="search-form-container">
                            <form class="border border-light p-5">
                                {% if workout['complete'] %}
                                    <img class="displayed" src="{{ url_for('vulnerability_defender.static', filename='imgs/trojan-4.png')}}">
                                {% endif %}
                                <h3 class="h4 mb-4 text-center">Please print this page to PDF for your records</h3>
                                <p class="h4 mb-4 text-center">Your Score: {{ data['points'] }}</p>
                                <p class="h5 mb-4 text-left">Company: {{ data['company'] }}</p>
                                <p class="h5 mb-4 text-left">Mission: {{ data['mission'] }}</p>
                                <p class="h5 mb-4 text-left">Service: {{ data['service'] }}</p>
                                <p class="h5 mb-4 text-left">Service Impact to Mission: {{ data['service_impact'] }}</p>
                                <p class="h5 mb-4 text-left">System Affected: {{ data['system'] }}</p>
                                <table class="table table-bordered table-hover">
                                  <tr>
                                      <th>Mission Confidentiality Impact</th>
                                      <th>Mission Integrity Impact</th>
                                      <th>Mission Availability Impact</th>
                                  </tr>
                                  <tr>
                                      <td>{{ data['confidentiality_scenario'] }}</td>
                                      <td>{{ data['integrity_scenario'] }}</td>
                                      <td>{{ data['availability_scenario'] }}</td>
                                  </tr>
                                  <tr>
                                      <td>{{ data['confidentiality_impact'] }}</td>
                                      <td>{{ data['integrity_impact'] }}</td>
                                      <td>{{ data['availability_impact'] }}</td>
                                  </tr>
                                </table>
                                <br>
                                <hr>
                                <br>
                                <h4 class="text-center">Vulnerabilities</h4>
                                {% for cve, vuln in data['vulnerabilities'].items() %}
                                    <div style="border: 1px solid black;">
                                        <table class="table table-bordered table-hover">
                                            <thead>
                                                <tr style="background-color: {% if vuln['correct'] %}#8fbc8f;{% else %}#f08080;{% endif %}">
                                                    <td colspan="4" align="center">
                                                        <a href="https://nvd.nist.gov/vuln/detail/{{ cve }}" target="_blank"
                                                           class="emphatic link-dark">{{ cve }}</a>
                                                    </td>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                  <td class="emphatic">Description:</td>
                                                  <td colspan="3">{{ vuln['description'] }}</td>
                                                </tr>
                                                <tr>
                                                    <td class="emphatic">Affected Asset:</td>
                                                    <td colspan="3">{{ vuln['asset'] }}</td>
                                                </tr>
                                                <tr>
                                                    <td class="emphatic">Exploitable from:</td>
                                                    <td colspan="3">{{ vuln['attack_vector'] }}</td>
                                                </tr>
                                                <tr>
                                                    <td class="emphatic">Complexity of attack:</td>
                                                    <td colspan="3">{{ vuln['complexity'] }}</td>
                                                </tr>
                                                <tr>
                                                    <td class="emphatic">Answer:</td>
                                                    <td colspan="3">
                                                        <ul>
                                                            <li>Response: {{ vuln['response'] }}</li>
                                                            <li>Correct Answer: {{ vuln['correct_answer'] }}</li>
                                                        </ul>
                                                    </td>
                                                </tr>
                                                <tr>

                                                </tr>
                                                <tr>
                                                    <td class="emphatic">Given Rationale:</td>
                                                    <td colspan="3">{{ vuln['rationale'] }}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        {% if data.level == "1" %}
                                            <table>
                                              <tr>
                                                  <th>Vulnerability Confidentiality Impact</th>
                                                  <th>Vulnerability Integrity Impact</th>
                                                  <th>Vulnerability Availability Impact</th>
                                              </tr>
                                              <tr>
                                                  <td>{{ vuln['v_confidentiality'] }}</td>
                                                  <td>{{ vuln['v_integrity'] }}</td>
                                                  <td>{{ vuln['v_availability'] }}</td>
                                              </tr>
                                            </table>
                                            <p></p>
                                        {% endif %}
                                        </div>
                                        <br>
                                    {% endfor %}
                                <button class="btn btn-info btn-block my-4" type="submit" name="action" value="startover"
                                                    formmethod="post" onclick="conf_startover()" formnovalidate>Start Over</button>
                            </form>
                        </div>
                    </div>
                </div><!-- End home-tab -->
            </div><!-- End tab-content -->
        </div>
    </main>
{% endblock %}