{% extends "base.html" %}

{% block content %}
    <div id="workout_id" hidden>{{ workout_id }}</div>
    <h2>Description</h2>
    <p>{{ description }}</p>
    <h2>Link</h2>
    {% if guac_path==None %}
        <a href="http://{{ workout_id }}{{ dns_suffix }}:8080">http://{{ workout_id }}{{ dns_suffix }}:8080</a>
    {% else %}
        <a href="http://{{ workout_id }}{{ dns_suffix }}:8080/guacamole/#/client/{{ guac_path}}">http://{{ workout_id }}{{ dns_suffix }}:8080/guacamole/#/client/{{ guac_path}}</a>
    {% endif %}
    <div class="input-field col s12">
            <input type="number" id="time" name="time" min="1" max="10">
            <label>How many hours would you like the workout to run (between 1 and 10 hours)?</label>
    </div>
    <div class="btn-ctn">
        <button id="start-vm" class="waves-effect waves-light btn" >START VM</button>
    </div>
    <div class="btn-ctn">
        <button id="stop-vm" class="waves-effect waves-light btn" >STOP VM</button>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>
        $(document).ready(function() {
            $("#start-vm").click(function () {
                var workout_id = $("#workout_id").html()
                var time = $("input#time").val();
                $.ajax({
                    type: "POST",
                    contentType: "application/json;charset=utf-8",
                    url: "/start_vm",
                    traditional: "true",
                    data: JSON.stringify({
                        "workout_id": workout_id,
                        "time": time
                    }),
                    dataType: "json",
                });
            });
            $("#stop-vm").click(function () {
                var workout_id = $("#workout_id").html()
                $.ajax({
                    type: "POST",
                    contentType: "application/json;charset=utf-8",
                    url: "/stop_vm",
                    traditional: "true",
                    data: JSON.stringify({
                        "workout_id": workout_id,
                    }),
                    dataType: "json",
                });
            });
        });
    </script>
{% endblock %}