{% extends "base.html" %}
{% block title %}Workout {{ workout_id }}{% endblock %}
{% block content %}
    <style>
        .form-ctn{
            width: 70%!important;
        }
        
        .landing_container *{
            margin:auto;
        }
        .nav{
            justify-content:center;
            padding:0;
            margin-top:0;
        }
        .nav li{
            margin:0;
            margin-top:1em;
            text-align:center;
            width:100%;
        }
        .tab-pane{
            margin:0;
        }
        #controls form{
            margin-top:1em;
        }

        .row{
            border: 1px solid black;
            padding-bottom:1%;
        }
        .control_button{
            margin-top:2%;
        }
        .tab-content{
            border-left: 1px solid black;
            margin-left:0;
        }
        .nav-item > .nav-link{
            color:maroon!important;
            font-size: 1.25em;
        }
        .nav-item > .active{
            background-color:maroon!important;
            color:white!important;
        }
    </style>
    <div class='landing_container col-lg-12'>
        <div class='row'>
        <ul class='nav nav-pills nav-stacked col-sm-2'>
            <li class='nav-item'>
                <a class='nav-link active' data-toggle="tab" href='#workout_controls'>Workout Controls</a>
            </li>
            <li class='nav-item'>
                <a class='nav-link' data-toggle="tab" href='#instructions'>Workout Instructions</a>
            </li>
            {% if assessment %}
            <li class='nav-item'>
                <a class='nav-link' data-toggle="tab" href='#assessment'>Assessment</a>
            </li>
            {% endif %}
        </ul>
        <div class='tab-content col-sm-9'>
            <div id='workout_controls' class='container tab-pane active'>
                <h2>Workout Control</h2>

                <p>Expiration date: {{ expiration }}</p>
                {% if shutoff=="expired" %}
                    <p>The workout is currently stopped</p>
                {% else %}
                    <p>Scheduled to turn off at approximately {{ shutoff }}</p>
                {% endif %}
                {% if complete %}
                    <p>Workout complete: </p><p style="color: green;">&#10004;</p>
                {% else %}
                    <p>Workout complete: </p><h2 style="color: red;">&#10008;</h2>
                {% endif %}

                {% if running %}
                <h2>Workout Servers</h2>
                {% if guac_path==None %}
                    <a href="http://{{ workout_id }}{{ dns_suffix }}:8080" target="_blank">Workout ID: <span style="text-transform: uppercase">{{ workout_id }}</span></a>
                {% else %}
                    <a href="http://{{ workout_id }}{{ dns_suffix }}:8080/guacamole/#/client/{{ guac_path}}" target="_blank">Workout ID: <span style="text-transform: uppercase">{{ workout_id }}</span></a>
                {% endif %}
                {% endif %}
                <br>
                <div class='control_button'>
                    <form action="/start_vm" method="post">
                        <div class="input-field col-sm-3" >
                                <input type="hidden" id="workout_id" name="workout_id" value="{{ workout_id }}">
                                <input type="number" id="time" name="time" value="2" min="1" max="10">
                                <label>Run time (1 - 10 hours)</label>
                        </div>
                        <div class="btn-ctn">
                            {% if running %}
                                <button type="submit" id="start-vm" class="waves-effect waves-light btn" disabled>START WORKOUT</button>
                            {% else %}
                                <button type="submit" id="start-vm" class="waves-effect waves-light btn" >START WORKOUT</button>
                            {% endif %}
                        </div>
                    </form>
                </div>
                <div class='control_button'>
                    <form action="/stop_vm" method="post">
                        <input type="hidden" id="workout_id" name="workout_id" value="{{ workout_id }}">
                        <div class="btn-ctn">
                            {% if running %}
                                <button id="stop-vm" class="waves-effect waves-light btn" >STOP WORKOUT</button>
                            {% else %}
                                <button id="stop-vm" class="waves-effect waves-light btn" disabled>STOP WORKOUT</button>
                            {% endif %}
                        </div>
                    </form>
                </div>
                <div class='control_button'>
                    <form action="/reset_vm" method="post">
                        <input type="hidden" id="workout_id" name="workout_id" value="{{ workout_id }}">
                        <div class="btn-ctn">
                                <button id="reset-vm" class="waves-effect waves-light btn" >RESET WORKOUT</button>
                        </div>
                    </form>
            
                </div>


                </p>
            </div> <!--Controls-->
            <div id="workout_id" hidden>{{ workout_id }}</div>
            <div class='container tab-pane fade' id='instructions'>
                <!-- <h2>Description</h2> -->
                <h2>{{ workout_type }} Workout</h2>
                <p>{{ description }}</p><br>
                {% if instructions!=None %}
                    <h2>Workout Instructions</h2>
                    <a href="{{ instructions }}" target="_blank">Workout Instructions</a>
                {% endif %}
                <div id='workout_instructions'>
                    <!-- {{ instructions }} -->
                    <h2>Workout Instructions</h2>
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse nec eros vitae libero pharetra tincidunt a tincidunt mauris. Maecenas egestas nulla lectus, sit amet hendrerit neque auctor quis. Duis nec lectus quis lacus varius gravida. Sed id lacus id nisl cursus dictum eget a erat. Sed vel mi pellentesque, pulvinar neque sit amet, tincidunt ex. Mauris in fermentum quam. Quisque vitae vehicula nisi. Integer porta augue vel tellus sodales dictum. Etiam sed efficitur justo. Donec eget pellentesque orci. Cras ultrices tortor ultrices efficitur pretium. Vivamus iaculis diam risus. Sed ipsum sem, scelerisque aliquet sem non, cursus convallis nibh. Quisque scelerisque sed sem vitae congue.

                        Curabitur maximus urna odio, nec consequat libero mattis quis. Quisque finibus nulla odio, at finibus risus feugiat nec. Nam finibus libero nisl, in interdum ipsum varius nec. Integer sit amet eleifend metus, eget dignissim nibh. Maecenas viverra mi nec turpis volutpat egestas. Vivamus iaculis gravida nunc ac mollis. Curabitur scelerisque iaculis rhoncus. Nulla at mauris at eros congue commodo ut eget risus. In lobortis erat nec elementum gravida. Aliquam erat volutpat. Sed tempor imperdiet aliquam. Etiam porttitor gravida eros. Nullam a est sit amet odio scelerisque auctor vitae eu lorem. Ut malesuada diam et libero rhoncus, sed rhoncus ex consectetur. Maecenas et efficitur ligula, vitae viverra ligula.
                        
                        Duis convallis nibh sed commodo venenatis. Mauris nisi urna, lacinia eget ante eu, eleifend lobortis lectus. Proin vehicula ipsum ut leo maximus pulvinar. Duis quis auctor turpis. Sed semper iaculis odio, id laoreet diam. Maecenas sed egestas risus. Sed a gravida nisl. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Nullam et sagittis nunc, non pretium diam. Nullam ornare ipsum ut libero ultrices commodo. Morbi faucibus ante quam, bibendum pharetra dui mattis ac. Nulla suscipit elit vitae enim fermentum pulvinar a eu metus. Pellentesque in faucibus ex. Ut vitae leo et libero finibus vestibulum. Integer venenatis nibh sodales, aliquet ipsum eu, vestibulum mauris.
                        
                        Vivamus faucibus ex est, eget bibendum nisi accumsan vitae. Maecenas id eros id tortor euismod accumsan vel non velit. Proin rhoncus congue sem mattis pulvinar. Mauris vel erat vitae ante lacinia varius. Aliquam lobortis velit elit. Phasellus luctus feugiat nisl non porttitor. Quisque eget finibus nisi. Mauris in diam vel justo semper tempor.</p>
                </div>


                <div id="loading-msg"></div>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
                <script>
                    $(document).ready(function(){
                        $("form").submit(function(){
                            $('#start-vm').attr('disabled','disabled');
                            $('#stop-vm').attr('disabled','disabled');
                            $('#reset-vm').attr('disabled','disabled');
                            $("#loading-msg").html('Please wait while the process completes' +
                                '</br><div class="loader"></div>');
                        });
                    });
                </script>
            </div> <!--Workout info container-->
            <div class='container tab-pane fade' id='assessment'>
                <form class='workout_assessment_form' action='/landing/{{ workout_id }}' method="POST">
                    {% if assessment %}
                        {% for question in assessment%}
                            {% if question['type'] == 'input' %}
                                <input type="hidden" name="question" value="{{ question['question'] }}" />
                                {{ question['question'] }}<br>
                                <input type='text' name="answer" />
                            {% elif question['type'] == 'upload' %}
                                {{ question['question'] }}<br>
                                <input type='file' id='assessment_file_upload' name='file_upload_test'><br><br>
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                    <button type='submit'>Submit</button>
                </form>
            </div>
        </div> <!--tab-content-->
        </div>
    </div> <!--Main Container-->
{% endblock %}